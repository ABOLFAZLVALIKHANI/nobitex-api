# آنتی فیشینگ

جهت امنیت حساب کاربری و همچنین اعتماد بیشتر کاربران به ایمیل هایی که از سمت توبیتکس ارسال میشود نیاز هست که کاربر بتواند کد یونیک برای حساب کاربری خود انتخاب کند که تمامی ایمیل هایی که از سمت نوبیتکس به صورت اتوماتیک ارسال میشود حاوی این کد باشد.
.این کد به کاربر این اطمینان را میدهد که این ایمیل قطعا از نوبیتکس ارسال شده است.

##ایجاد کد آنتی فیشینگ

>نمونه درخواست:

```shell
curl --location --request POST 'https://api.nobitex.ir/security/anti-phishing' \
--header 'Authorization: Token 312616c62a1b5f81a7f1049051fda3382cf41941' \
--form 'code="sample_anti_phishing"' \
--form 'otp_code="123456"'
```


> در صورت فراخوانی درست، پاسخ به این صورت خواهد بود:

```json
{
    "status": "ok"
}
```

* **آدرس:** `POST /security/anti-phishing`
* **محدودیت فراخوانی:** ۵ درخواست در هر دقیقه


* پارامترهای ورودی:

پارامتر | نوع    | پیش‌فرض | توضیحات                                      | نمونه
------- |--------|---------|----------------------------------------------| ---------
code | string | الزامی  | کد آنتی فیشینگ تعیین شده توسط کاربر          | sample_anti_phishing
otp_code | number | الزامی  | کد یکبار مصرف ارسال شده به شماره همراه کاربر | 12345


> **حالت‌های خطا**
> 
> در صورتی که کدیکبار مصرف ارسال شده، نامعتبر باشد با این خطا روبرو خواهید بود.
```json
{
  "status": "failed",
  "code": "InvalidOTPCode",
  "message": "Please use otp/request endpoint",
}
```

> در صورتی که کد تعیین شده بیشتر از ۲۰ کاراکتر باشد با این خطا مواجه خواهید شد
```json
{
    "all": "value too long for type character varying(20)"
}
```

> در صورتی طول کد تعیین شده کمتر از ۸ کاراکتر باشد
```json
{
    "status": "failed",
    "code": "ValidationError",
    "message": {
        "code": [
            "طول این مقدار باید حداقل 8 کاراکتر باشد (طولش 3 است).",
            "طول این مقدار باید حداقل 8 کاراکتر باشد (طولش 3 است)."
        ]
    }
}
```


##دریافت کد آنتی فیشینگ

>نمونه درخواست:

```shell
curl --location --request GET 'https://api.nobitex.ir/security/anti-phishing' \
--header 'Authorization: Token 312616c62a1b5f81a7f1049051fda3382cf41941' \
```


> در صورت فراخوانی درست، پاسخ به این صورت خواهد بود:

```json
{
   "anti_phishing_code": "sa*********ng"
}
```
